<!doctype html><html lang=pt-br>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=content-language content="pt-br">
<meta name=color-scheme content="light dark">
<meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; prefetch-src 'self'; connect-src 'self';">
<meta name=author content="Eduardo Weiland">
<meta name=description content="Com várias ideias para o projeto do Placarduino, o display de 16x2 não será suficiente para exibir todas as informações. E além disso, da forma como o display está montado hoje, são utilizados muitos pinos do Arduino, que poderiam ser aproveitados para outras funções. Então, nesse post, eu vou mostrar como eu fiz a substituição do display 16x2 por um display 20x4 com um módulo adaptador I²C.
 Antes de mais nada: a escolha do display.">
<meta name=keywords content="blog,home,portfolio,personal,developer,maker">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Placarduino++: adicionando um display maior para exibir mais informações">
<meta name=twitter:description content="Com várias ideias para o projeto do Placarduino, o display de 16x2 não será suficiente para exibir todas as informações. E além disso, da forma como o display está montado hoje, são utilizados muitos pinos do Arduino, que poderiam ser aproveitados para outras funções. Então, nesse post, eu vou mostrar como eu fiz a substituição do display 16x2 por um display 20x4 com um módulo adaptador I²C.
 Antes de mais nada: a escolha do display.">
<meta property="og:title" content="Placarduino++: adicionando um display maior para exibir mais informações">
<meta property="og:description" content="Com várias ideias para o projeto do Placarduino, o display de 16x2 não será suficiente para exibir todas as informações. E além disso, da forma como o display está montado hoje, são utilizados muitos pinos do Arduino, que poderiam ser aproveitados para outras funções. Então, nesse post, eu vou mostrar como eu fiz a substituição do display 16x2 por um display 20x4 com um módulo adaptador I²C.
 Antes de mais nada: a escolha do display.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://eduardoweiland.info/posts/2017/11/placarduino-adicionando-um-display-maior-para-exibir-mais-informacoes/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-11-02T20:10:24-02:00">
<meta property="article:modified_time" content="2017-11-02T20:10:24-02:00">
<meta property="og:see_also" content="https://eduardoweiland.info/posts/2018/02/reset-automatico-do-placarduino-apos-o-fim-do-jogo/"><meta property="og:see_also" content="https://eduardoweiland.info/posts/2018/02/fim-de-jogo-para-o-placarduino/"><meta property="og:see_also" content="https://eduardoweiland.info/posts/2018/01/cartoes-de-acesso-para-o-placarduino/"><meta property="og:see_also" content="https://eduardoweiland.info/posts/2018/01/refatoracao-do-placarduino/"><meta property="og:see_also" content="https://eduardoweiland.info/posts/2018/01/atualizacao-do-placarduino-reducao-de-pontos/"><meta property="og:see_also" content="https://eduardoweiland.info/posts/2017/11/display-maior-numeros-maiores/">
<title>
Placarduino++: adicionando um display maior para exibir mais informações · Eduardo Weiland
</title>
<link rel=canonical href=https://eduardoweiland.info/posts/2017/11/placarduino-adicionando-um-display-maior-para-exibir-mais-informacoes/>
<link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.1.7" as=font type=font/woff2 crossorigin>
<link rel=stylesheet href=/css/coder.min.cbf6f68b2a836dd1d34f005153262dd21d148461cf33684940f1bb4c048821b1.css integrity="sha256-y/b2iyqDbdHTTwBRUyYt0h0UhGHPM2hJQPG7TASIIbE=" crossorigin=anonymous media=screen>
<link rel=stylesheet href=/css/coder-dark.min.dde8a61eb31a32353b4baf3d9113f03c4ea2a8ca9bb736f59ca2d2b2cb664f0b.css integrity="sha256-3eimHrMaMjU7S689kRPwPE6iqMqbtzb1nKLSsstmTws=" crossorigin=anonymous media=screen>
<link rel=stylesheet href=/css/custom.css>
<link rel=icon type=image/png href=/images/favicon32.png sizes=32x32>
<link rel=icon type=image/png href=/images/favicon16.png sizes=16x16>
<link rel=apple-touch-icon href=/images/apple-touch-icon.png>
<link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png>
<meta name=generator content="Hugo 0.88.1">
</head>
<body class="preload-transitions colorscheme-auto">
<div class=float-container>
<a id=dark-mode-toggle class=colorscheme-toggle>
<i class="fa fa-adjust fa-fw" aria-hidden=true></i>
</a>
</div>
<main class=wrapper>
<nav class=navigation>
<section class=container>
<a class=navigation-title href=/>
Eduardo Weiland
</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle>
<i class="fa fa-bars fa-fw" aria-hidden=true></i>
</label>
<ul class=navigation-list>
<li class=navigation-item>
<a class=navigation-link href=/posts/>Blog</a>
</li>
</ul>
</section>
</nav>
<div class=content>
<section class="container post">
<article>
<header>
<div class=post-title>
<h1 class=title>
<a class=title-link href=https://eduardoweiland.info/posts/2017/11/placarduino-adicionando-um-display-maior-para-exibir-mais-informacoes/>
Placarduino++: adicionando um display maior para exibir mais informações
</a>
</h1>
</div>
<div class=post-meta>
<div class=date>
<span class=posted-on>
<i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2017-11-02T20:10:24-02:00>
Nov 2, 2017
</time>
</span>
<span class=reading-time>
<i class="fa fa-clock-o" aria-hidden=true></i>
5 minutos de leitura
</span>
</div>
<div class=tags>
<i class="fa fa-tag" aria-hidden=true></i>
<a href=/tags/arduino/>arduino</a>
<span class=separator>•</span>
<a href=/tags/eletronica/>eletronica</a>
<span class=separator>•</span>
<a href=/tags/placarduino/>placarduino</a></div>
</div>
</header>
<div>
<img src=/images/placarduino-display-20x4.png alt="Featured image">
<p>Com várias ideias para o projeto do Placarduino, o display de 16x2 não será
suficiente para exibir todas as informações. E além disso, da forma como o
display está montado hoje, são utilizados muitos pinos do Arduino, que poderiam
ser aproveitados para outras funções. Então, nesse post, eu vou mostrar como eu
fiz a substituição do display 16x2 por um display 20x4 com um módulo adaptador
I²C.</p>
<hr>
<p>Antes de mais nada: a escolha do display. Eu utilizei um LCD que já veio com o
controlador I²C soldado na parte de trás do display. Existe a possibilidade de
comprar apenas o módulo adaptador e soldar ao display ou montar em uma protoboard.</p>
<p>Apenas para deixar claro: eu estou trocando o tamanho do display e também adicionando
o controlador I²C ao mesmo tempo por conveniência. Isso não significa que o display
20x4 sempre deve ser utilizado com I²C: você pode utilizar o display 20x4 ligado
diretamente ao Arduino como foi feito antes com o display 16x2, e também pode
utilizar o controlador I²C com o display 16x2.</p>
<p>Utilizando um controlador I²C para ligar o LCD é possível reduzir consideravelmente
os pinos utilizados: sem ele são necessários 6 pinos digitais do Arduino; com ele
são apenas 2 pinos analógicos.</p>
<p>O I²C (sigla de Inter-Integrated Circuit) é um barramento com comunicação serial
que utiliza apenas duas linhas: uma para o clock (SCL - Serial Clock) e outra
para os dados seriais (SDA - Serial Data). Vários periféricos podem ser conectados
ao mesmo tempo no barramento, mas sempre deve existir um nodo master para gerar
o clock e controlar a comunicação. Os outros nodos são os slaves e cada um possui
um endereço único dentro do barramento.</p>
<h2 id=montagem>
Montagem
<a class=heading-link href=#montagem>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h2>
<p>Antes de começar, o antigo display 16x2 pode ser removido da protoboard, junto
com todos os cabos e resistores que foram utilizados para ele. Como o novo display
possui o controlador soldado na parte de trás, ele não precisa ser montado na
protoboard. Vou utilizar apenas 4 cabos macho-fêmea ligados nos pinos do controlador.</p>
<p><img src=/images/display-lcd-utilizado.jpg alt="Display LCD utilizado">
<em>Display LCD que estou utilizando, com os cabos conectados no controlador I²C</em></p>
<p>O Arduino possui dois pinos analógicos específicos para comunicação I²C: a linha
SDA deve ser ligada no pino A4 e a linha SCL deve ser ligada no pino A5 (no
Arduino UNO). Como nesse momento eu só terei o display LCD conectado no barramento
I²C, eu irei conectar esses pinos do Arduino diretamente aos pinos da placa
controladora do display. Fora isso, só é necessário ligar o GND e o Vcc (5V) e
a montagem está pronta:</p>
<p><img src=/images/placarduino-display-20x4.png alt="Esquema de ligação do display com I²C"></p>
<h2 id=atualizando-o-código-para-ic>
Atualizando o código para I²C
<a class=heading-link href=#atualizando-o-c%c3%b3digo-para-ic>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h2>
<p>Com a montagem finalizada, resta atualizar o código. A primeira alteração que
precisa ser feita é incluir uma biblioteca que suporte a comunicação com o LCD
por I²C. Como <a href=/posts/2017/10/substituindo-a-ide-do-arduino-pelo-platformio/>agora eu estou utilizando o PlatformIO</a>, eu apenas precisei
editar o <code>platformio.ini</code> e substituir a biblioteca <code>LiquidCrystal@1.3.4</code> por
<code>LiquidCrystal_I2C@1.1.2</code>(eu testei algumas outras bibliotecas, mas essa pareceu
funcionar melhor). Como foi alterada a biblioteca, também é necessário alterar
o <code>#include</code> dela.</p>
<p><strong>Diff das alterações:</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:#f55>-#include &lt;LiquidCrystal.h&gt;
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+#include &lt;LiquidCrystal_I2C.h&gt;
</span></code></pre></div><p>A única configuração necessária para comunicar com o display I²C é o endereço
dele no barramento. Os controladores já vem com um endereço configurado que pode
ser diferente entre diferentes modelos e fabricantes, mas pode ser descoberto
com um I²C scanner como mostrado em um <a href=http://playground.arduino.cc/Main/I2cScanner>tutorial no site do Arduino</a>
(em inglês). O display LCD que eu estou utilizando possui o endereço <code>0x3F</code>, mas
se o seu for diferente, lembre-se de alterar no código abaixo.</p>
<p><strong>Diff das alterações:</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:#f55>-#define PIN_LCD_D7        8
</span><span style=color:#f55>-#define PIN_LCD_D6        9
</span><span style=color:#f55>-#define PIN_LCD_D5       10
</span><span style=color:#f55>-#define PIN_LCD_D4       11
</span><span style=color:#f55>-#define PIN_LCD_EN       12
</span><span style=color:#f55>-#define PIN_LCD_RS       13
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+#define LCD_I2C_ADDR   0x3F
</span><span style=color:#50fa7b;font-weight:700>+#define LCD_COLS         20
</span><span style=color:#50fa7b;font-weight:700>+#define LCD_ROWS          4
</span></code></pre></div><p>Com a antiga biblioteca, os pinos utilizados na comunicação eram configurados no
construtor do objeto e o tamanho do display era configurado com o método <code>begin()</code>.
Com essa nova biblioteca tudo isso é feito no construtor.</p>
<p><strong>Diff das alterações:</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:#f55>-// Inicializa o objeto LCD configurando os pinos de comunicação
</span><span style=color:#f55>-LiquidCrystal lcd(
</span><span style=color:#f55>-    PIN_LCD_RS,
</span><span style=color:#f55>-    PIN_LCD_EN,
</span><span style=color:#f55>-    PIN_LCD_D4,
</span><span style=color:#f55>-    PIN_LCD_D5,
</span><span style=color:#f55>-    PIN_LCD_D6,
</span><span style=color:#f55>-    PIN_LCD_D7
</span><span style=color:#f55>-);
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+// Inicializa o objeto LCD configurando o endereço de comunicação e tamanho
</span><span style=color:#50fa7b;font-weight:700>+LiquidCrystal_I2C lcd(LCD_I2C_ADDR, LCD_COLS, LCD_ROWS);
</span></code></pre></div><p>A função <code>setupLCD()</code> também precisa ser alterada. Em vez de chamar o método
<code>lcd.begin()</code> com o tamanho do display, é necessário chamar o método <code>init()</code>
sem parâmetros, que irá inicializar a comunicação I²C e também o display. Além
disso, também é necessário habilitar a luz de fundo do LCD explicitamente via
código.</p>
<p><strong>Diff das alterações:</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff> void setupLCD()
 {
<span style=color:#f55>-    // Configura o tamanho do LCD: 16 colunas e 2 linhas
</span><span style=color:#f55>-    lcd.begin(16, 2);
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+    lcd.init();
</span><span style=color:#50fa7b;font-weight:700>+    lcd.backlight();
</span><span style=color:#50fa7b;font-weight:700></span> }
</code></pre></div><p>Com isso feito, o display já deve estar funcionando. Mas os dados que são
exibidos nele ainda estão formatados para um display 16x2, então vamos ocupar
melhor o espaço, começando pela tela de início.</p>
<p><strong>Diff das alterações:</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff> void printWelcome()
 {
     lcd.clear();

<span style=color:#f55>-    // Posiciona o cursor na primeira coluna da primeira linha
</span><span style=color:#f55>-    lcd.setCursor(0, 0);
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+    // Posiciona o cursor na terceira coluna da segunda linha
</span><span style=color:#50fa7b;font-weight:700>+    lcd.setCursor(2, 1);
</span><span style=color:#50fa7b;font-weight:700></span>     lcd.print(&#34;PLACARDUINO v1.0&#34;);

<span style=color:#f55>-    // Posiciona o cursor na terceira coluna da segunda linha
</span><span style=color:#f55>-    lcd.setCursor(2, 1);
</span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+    // Posiciona o cursor na quinta coluna da terceira linha
</span><span style=color:#50fa7b;font-weight:700>+    lcd.setCursor(4, 2);
</span><span style=color:#50fa7b;font-weight:700></span>     lcd.print(&#34;a.k.a. DAMN&#34;);
 }
</code></pre></div><p>A parte do placar que exibe a pontuação eu vou manter como está - por enquanto 😉</p>
<h2 id=roadmap>
Roadmap
<a class=heading-link href=#roadmap>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h2>
<p>Agora que a protoboard tem bastante espaço livre para novos componentes e o
display é grande o suficiente para exibir muitas informações, o projeto pode
evoluir muito mais. Eu já fiz uma grande mudança na tela que exibe a pontuação
(que merece um post separado) e já estou pesquisando a tecnologia de tags RFID
para identificar os jogadores. Ideias não faltam, e o conhecimento se adquire.</p>
<p>Como sempre, o código-fonte e o projeto do Fritzing estão no GitHub:</p>
<ul>
<li>Versão desse post: <a href=https://github.com/eduardoweiland/placarduino/tree/v1.2>https://github.com/eduardoweiland/placarduino/tree/v1.2</a></li>
<li>Versão mais recente: <a href=https://github.com/eduardoweiland/placarduino>https://github.com/eduardoweiland/placarduino</a></li>
</ul>
</div>
<footer>
<section class=see-also>
<h3 id=see-also-in-placarduino>
See also in placarduino
<a class=heading-link href=#see-also-in-placarduino>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<nav>
<ul>
<li>
<a href=/posts/2018/02/reset-automatico-do-placarduino-apos-o-fim-do-jogo/>Reset automático do Placarduino após o fim do jogo</a>
</li>
<li>
<a href=/posts/2018/02/fim-de-jogo-para-o-placarduino/>Fim de jogo para o Placarduino</a>
</li>
<li>
<a href=/posts/2018/01/cartoes-de-acesso-para-o-placarduino/>Cartões de acesso para o Placarduino</a>
</li>
<li>
<a href=/posts/2018/01/refatoracao-do-placarduino/>Refatoração do Placarduino</a>
</li>
<li>
<a href=/posts/2018/01/atualizacao-do-placarduino-reducao-de-pontos/>Atualização do Placarduino: redução de pontos</a>
</li>
<li>
<a href=/posts/2017/11/display-maior-numeros-maiores/>Display maior, números maiores</a>
</li>
</ul>
</nav>
</section>
</footer>
</article>
</section>
</div>
<footer class=footer>
<section class=container>
&copy;
2011 -
2021
Eduardo Weiland
&#183;
<a rel="license noopener" href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a>
&#183;
<a rel=noopener href=https://gitlab.com/eduardoweiland/homepage>Free Software</a>
</section>
</footer>
</main>
<script src=/js/coder.min.235666b114443867d43eeb5799d51f6252965e5163f338285e113fa381d3d27e.js integrity="sha256-I1ZmsRREOGfUPutXmdUfYlKWXlFj8zgoXhE/o4HT0n4="></script>
</body>
</html>